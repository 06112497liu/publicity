<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bbd.dao.ReportDao">

    <!-- 按区域统计地图数据 -->
    <select id="queryDistrictExStatistics" resultType="java.util.Map">
		SELECT
			region AS item,
			count(1) AS total
		FROM
			bbd_pub_company_ex_item_pre
		WHERE
			del_flag = 0
		AND
			num > 0
		GROUP BY
			region;
    </select>

    <!-- 按区域统计年报信息异常企业数量 -->
    <select id="queryDistrictAnnualExStatistics" resultType="java.util.Map">
    	SELECT
			region AS item,
			count(1) AS total
		FROM
			bbd_pub_company_ex_item_pre
		WHERE
			del_flag = 0
		AND
			annual_num > 0
		GROUP BY
			region
    </select>

    <!-- 按区域统计年报信息异常企业数量 -->
    <select id="queryDistrictInsExStatistics" resultType="java.util.Map">
    	SELECT
			region AS item,
			count(1) AS total
		FROM
			bbd_pub_company_ex_item_pre
		WHERE
			del_flag = 0
		AND
			instantly_num > 0
		GROUP BY
			region
    </select>
    
    <!-- 按区域统计两者都异常的企业数量 -->
    <select id="queryDistrictBothExStatistics" resultType="java.util.Map">
		SELECT
			region AS item,
			count(1) AS total
		FROM
			bbd_pub_company_ex_item_pre
		WHERE
			del_flag = 0
		AND
			instantly_num > 0
		AND
			annual_num > 0
		GROUP BY
			region;    
    </select>

    <!-- 按行业统计地图数据 -->
    <select id="queryIndustryExStatistics" resultType="java.util.Map">
        SELECT
        primary_industry AS item,
        count(1) AS total
        FROM
        bbd_pub_company_ex_item_pre
        WHERE del_flag = 0
        AND num > 0
        GROUP BY
        primary_industry
    </select>

    <!-- 按行业统计年报信息异常企业数量 -->
    <select id="queryIndustryAnnualExStatistics" resultType="java.util.Map">
        SELECT
        primary_industry AS item,
        count(1) AS total
        FROM
			bbd_pub_company_ex_item_pre
		WHERE
			del_flag = 0
		AND
        	annual_num > 0
        GROUP BY
        primary_industry
    </select>

    <!-- 按行业统计年报信息异常企业数量 -->
    <select id="queryIndustryInsExStatistics" resultType="java.util.Map">
        SELECT
        	primary_industry AS item,
        	count(1) AS total
        FROM
			bbd_pub_company_ex_item_pre
		WHERE
			del_flag = 0
		AND
        	instantly_num > 0
        GROUP BY
        	primary_industry
    </select>
    
    <!-- 按行业统计两者都异常的企业数量 -->
    <select id="queryIndustryBothExStatistics" resultType="java.util.Map">
		SELECT
			primary_industry AS item,
			count(1) AS total
        FROM
			bbd_pub_company_ex_item_pre
		WHERE
			del_flag = 0
		AND
			instantly_num > 0
		AND
			annual_num > 0
		GROUP BY
			primary_industry;    
    </select>
    
    <!-- 按企业性质统计地图数据 -->
    <select id="queryCompanyPropertyExStatistics" resultType="java.util.Map">
        SELECT
        	CONCAT(company_property) AS item,
        	count(1) AS total
        FROM
			bbd_pub_company_ex_item_pre
		WHERE
			del_flag = 0
		AND
        	num > 0
        GROUP BY
        	company_property
    </select>

    <!-- 按企业性质统计年报信息异常企业数量 -->
    <select id="queryCompanyPropertyAnnualExStatistics" resultType="java.util.Map">
        SELECT
        	CONCAT(company_property) AS item,
        	count(1) AS total
        FROM
			bbd_pub_company_ex_item_pre
		WHERE
			del_flag = 0
		AND
        	annual_num > 0
        GROUP BY
        	company_property
    </select>

    <!-- 按企业性质统计年报信息异常企业数量 -->
    <select id="queryCompanyPropertyInsExStatistics" resultType="java.util.Map">
        SELECT
        CONCAT(company_property) AS item,
        count(1) AS total
        FROM
			bbd_pub_company_ex_item_pre
		WHERE
			del_flag = 0
		AND
        	instantly_num > 0
        GROUP BY
        	company_property
    </select>
    
    <!-- 按企业性质统计两者都异常的企业数量 -->
    <select id="queryCompanyPropertyBothExStatistics" resultType="java.util.Map">
		SELECT
			company_property AS item,
			count(1) AS total
        FROM
			bbd_pub_company_ex_item_pre
		WHERE
			del_flag = 0
		AND
			instantly_num > 0
		AND
			annual_num > 0
		GROUP BY
			company_property;    	
    </select>
    
    <!-- 查询各个区域的企业数量 -->
    <select id="queryCompanyCountGroupDistrict" resultType="java.util.Map">
		SELECT
			region item,
			count(1) total
        FROM
			bbd_pub_company_ex_item_pre
		WHERE
			del_flag = 0
		GROUP BY
			region
    </select>
	
	<!-- 查询各个行业的企业数量 -->
	<select id="queryCompanyCountGroupIndustry" resultType="java.util.Map">
		SELECT
			primary_industry item,
			count(1) total
        FROM
			bbd_pub_company_ex_item_pre
		WHERE
			del_flag = 0
		GROUP BY
			primary_industry		
	</select>
	
	<!-- 查询贵阳市企业总量 -->
	<select id="queryWholeCount" resultType="java.lang.Integer">
		SELECT COUNT(1) FROM bbd_pub_company_ex_item_pre WHERE del_flag = 0
	</select>
	
	<!-- 查询贵阳市年报异常企业数量 -->
	<select id="queryWholeAnnualExNum" resultType="java.lang.Integer">
		SELECT COUNT(1) FROM bbd_pub_company_ex_item_pre WHERE del_flag = 0 AND annual_num > 0
	</select>
	
	<!-- 查询贵阳市即时信息异常企业数量 -->
	<select id="queryWholeInsExNum" resultType="java.lang.Integer">
		SELECT COUNT(1) FROM bbd_pub_company_ex_item_pre WHERE del_flag = 0 AND instantly_num > 0
	</select>	
	
	<!-- 查询贵阳市两者都异常的企业数量 -->
	<select id="queryWholeBothExNum" resultType="java.lang.Integer">
		SELECT COUNT(1) FROM bbd_pub_company_ex_item_pre WHERE del_flag = 0 AND instantly_num > 0 AND annual_num > 0
	</select>

	<!-- 查询归贵阳市异常企业总量 -->
	<select id="queryWholeExNum" resultType="java.lang.Integer">
		SELECT COUNT(1) FROM bbd_pub_company_ex_item_pre WHERE del_flag = 0 AND num > 0
	</select>
</mapper>












